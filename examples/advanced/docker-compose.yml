services:
  app:
    image: node:20-slim
    user: "${CURRENT_UID}:${CURRENT_GID}"
    working_dir: /app
    volumes:
      - .:/app:cached
    profiles:
      - develop
      - stage
    command: npm run dev

  api:
    image: python:3.11-slim
    environment:
      - DATABASE_URL=${DATABASE_URL}
    profiles:
      - stage
      - main

  worker:
    image: redis:alpine
    profiles:
      - main
